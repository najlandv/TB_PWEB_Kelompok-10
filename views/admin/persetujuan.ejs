<% const persetujuanContent = '' %>
<%- include('./template', { content: persetujuanContent }) %>

<div class="container">
    <h1 class="custom-heading">Permintaan Surat Masuk</h1>
    <table>
        <thead>
            <tr>
                <th>No.</th>
                <th>Tanggal</th>
                <th>NIM</th>
                <th>Nama Mahasiswa</th>
                <th>Detail</th>
                <th>Action</th>
                <th>Status</th>
            </tr>
            <tbody>
                <% lihatPersetujuan.forEach ( (persetujuan, index =0) => { %>
                <tr>
                    <td><%= index+1 %></td>
                    <td><%= persetujuan.tanggalDikirim %></td>
                    <td><%= persetujuan.User.no_identitas %></td>
                    <td><%= persetujuan.User.nama_depan%> <%= persetujuan.User.nama_belakang %> </td>
                    <td>
                        <a class="btn" href="detail"><i class="fa-solid fa-circle-info fa-lg"></i>Detail</a>
                    </td>
                    <td>
                        <button type ="submit" class="btn" id="terima-button" <% if (persetujuan.acceptByAdmin  ) { %>
                            
                        <% } %>><i class="fa-solid fa-circle-check fa-lg"></i>Terima</button>
                        <button type="button" class="btn" id="tolak-button" <% if (persetujuan.acceptByAdmin != 0) { %>
                         
                        <% } %>><i class="fa-solid fa-circle-xmark fa-lg"></i>Tolak</button>
                    </td>
                    <td style="font-style: italic; font-size: small; color:#4F6F52; text-decoration: underline;"> 
                        <% if (persetujuan.acceptByAdmin==0) { %>
                     Menunggu
                     <% } else if (persetujuan.acceptByAdmin==1) { %>
  
                    Diterima
                    <% } else if (persetujuan.acceptByAdmin==2) { %>
                     
                    <% } else { %>
                     undefined
                        <% } %>
                     
                </td>
                </tr>
                <!-- modal terima -->
                <div id="modalterima" class="modal" aria-labelledby="modal-title" role="dialog" aria-modal="true">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 id="modal-title">Accepted Confirmation</h2>
                        </div>
                        <div class="modal-body">
                            <p>Apakah Anda yakin menerima formulir ini?</p>
                        </div>
                        <div class="modal-footer">
                            <div style="display: flex; justify-content: space-evenly; width: 100%; ">
                                <button id="cancel-accept" type="button" class="cancel-button">Cancel</button>
                                <form action="/admin/persetujuan/<%= persetujuan.nomorSurat %>" method="POST">
                                    <button id="confirm-accept" type="submit" class="confirm-button">Yes</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- modal tolak-->
                <div id="modaltolak" class="modal" aria-labelledby="modal-title" role="dialog" aria-modal="true">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 id="modal-title">Rejected Confirmation</h2>
                        </div>
                        <div class="modal-body">
                            <p>Apakah Anda yakin menolak formulir ini?</p>
                        </div>
                        <div class="modal-footer">
                            <button id="cancel-reject" type="button" class="cancel-button">Cancel</button>
                            <form action="/admin/persetujuan/<%= persetujuan.nomorSurat %>" method="POST">
                                <button id="confirm-reject" type="submit" class="confirm-button">Yes</button></form>
                        </div>
                    </div>
    </div>
    
                <% }) %>
            </tbody>
        </thead>
    </table>

    

    

    <script>
        // Menampilkan modal saat tombol terima diklik
        document.getElementById('terima-button').addEventListener('click', function() {
            document.getElementById('modalterima').classList.add('show');
        });
  
        // Menangani klik tombol "terima" di modal
        document.getElementById('confirm-accept').addEventListener('click', function() {
            document.getElementById('accept-form').submit();
        });
  
        // Menangani klik tombol "Cancel" di modal
        document.getElementById('cancel-accept').addEventListener('click', function() {
            document.getElementById('modalterima').classList.remove('show');
        });
        
        // Menampilkan modal saat tombol tolak diklik
        document.getElementById('tolak-button').addEventListener('click', function() {
            document.getElementById('modaltolak').classList.add('show');
        });
  
        // Menangani klik tombol "terima" di modal
        document.getElementById('confirm-reject').addEventListener('click', function() {
            document.getElementById('reject-form').submit();
        });
  
        // Menangani klik tombol "Cancel" di modal
        document.getElementById('cancel-reject').addEventListener('click', function() {
            document.getElementById('modaltolak').classList.remove('show');
        });

    </script> 
</div>
